const f="https://api.astravel.alvarohuaysara.me";async function C(e){const n=await fetch(`${f}/api/login`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)}),t=await n.json();return console.log(t),{ok:n.ok,data:t.data,token:t.token,message:t.message,errors:t.errors}}async function P(e){const n=await fetch(`${f}/api/register`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)}),t=await n.json();return console.log(t),{ok:n.ok,data:t.data,token:t.token,message:t.message,errors:t.errors}}async function w(e){return{ok:(await fetch(`${f}/api/logout`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${e}`}})).ok}}async function M(e,n){const t=await fetch(`${f}/api/verify-email${e}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${n}`}}),o=await t.json();return console.log(o),{ok:t.ok,message:o.message}}async function U(e){const t=await(await fetch(`${f}/api/password-email`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:e})})).json();console.log(t)}async function J(e,n){const t=await fetch(`${f}/api/password-reset${e}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)}),o=await t.json();return console.log(o),{ok:t.ok,message:o.message}}let l=[],E=(e,n)=>{let t=[],o={get(){return o.lc||o.listen(()=>{})(),o.value},l:n||0,lc:0,listen(s,i){return o.lc=t.push(s,i||o.l)/2,()=>{let r=t.indexOf(s);~r&&(t.splice(r,2),--o.lc||o.off())}},notify(s,i){let r=!l.length;for(let a=0;a<t.length;a+=2)l.push(t[a],t[a+1],o.value,s,i);if(r){for(let a=0;a<l.length;a+=5){let d;for(let c=a+1;!d&&(c+=5)<l.length;)l[c]<l[a+1]&&(d=l.push(l[a],l[a+1],l[a+2],l[a+3],l[a+4]));d||l[a](l[a+2],l[a+3],l[a+4])}l.length=0}},off(){},set(s){let i=o.value;i!==s&&(o.value=s,o.notify(i))},subscribe(s,i){let r=o.listen(s,i);return s(o.value),r},value:e};return o};const T=5,p=6,g=10;let k=(e,n,t,o)=>(e.events=e.events||{},e.events[t+g]||(e.events[t+g]=o(s=>{e.events[t].reduceRight((i,r)=>(r(i),i),{shared:{},...s})})),e.events[t]=e.events[t]||[],e.events[t].push(n),()=>{let s=e.events[t],i=s.indexOf(n);s.splice(i,1),s.length||(delete e.events[t],e.events[t+g](),delete e.events[t+g])}),O=1e3,S=(e,n)=>k(e,o=>{let s=n(o);s&&e.events[p].push(s)},T,o=>{let s=e.listen;e.listen=(...r)=>(!e.lc&&!e.active&&(e.active=!0,o()),s(...r));let i=e.off;return e.events[p]=[],e.off=()=>{i(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let r of e.events[p])r();e.events[p]=[]}},O)},()=>{e.listen=s,e.off=i}}),m=e=>e,u={},v={addEventListener(){},removeEventListener(){}};function L(){try{return typeof localStorage<"u"}catch{return!1}}L()&&(u=localStorage);let N={addEventListener(e,n,t){window.addEventListener("storage",n),window.addEventListener("pageshow",t)},removeEventListener(e,n,t){window.removeEventListener("storage",n),window.removeEventListener("pageshow",t)}};typeof window<"u"&&(v=N);function j(e,n=void 0,t={}){let o=t.encode||m,s=t.decode||m,i=E(n),r=i.set;i.set=c=>{typeof c>"u"?delete u[e]:u[e]=o(c),r(c)};function a(c){c.key===e?c.newValue===null?r(void 0):r(s(c.newValue)):u[e]||r(void 0)}function d(){i.set(u[e]?s(u[e]):n)}return S(i,()=>{if(d(),t.listen!==!1)return v.addEventListener(e,a,d),()=>{v.removeEventListener(e,a,d)}}),i}const h=j("authState",void 0,{encode:JSON.stringify,decode:JSON.parse});function $(e,n){h.set({user:e,token:n})}function A(){h.set(void 0)}const y=h.get()?.user;if(y){const e=document.querySelector('a[href="login"]'),n=document.querySelector('a[href="register"]'),t=document.querySelector(".navbar nav ul");e&&e.parentNode&&t.removeChild(e.parentNode),n&&n.parentNode&&t.removeChild(n.parentNode);const o=document.createElement("li");o.innerHTML=`<span>${y.name}</span>`;const s=document.createElement("li");s.innerHTML='<button id="btn-logout" class="btn">Logout</button>',t.appendChild(o),t.appendChild(s);const i=document.getElementById("btn-logout");i.onclick=async()=>{await w(h.get()?.token),A(),location.href="/login"}}export{h as $,$ as a,P as b,C as l,J as r,U as s,M as v};
